<!DOCTYPE html>
<html>
  <head>
    <title>Mapa de Caixas de Fibra Ótica</title>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAi8EElPj7KR5Ws9IN9z3un0vf6odZvXP8
      "
      defer
    ></script>
    <script defer>
      let map;
      let markers = [];

      function initMap() {
        map = new google.maps.Map(document.getElementById("map"), {
          center: { lat: -23.5505, lng: -46.6333 },
          zoom: 10,
        });



        for (let i = 0; i < markers.length; i++) {
          addMarker(markers[i]);
        }

        map.addListener("click", (event) => {
          const position = event.latLng.toJSON();
          addMarker(position);
          markers.push(position);
        });
      }

      function addMarker(position) {
        const marker = new google.maps.Marker({
          position: position,
          map: map,
        });
      }

      function saveMarkers() {
        localStorage.setItem("markers", JSON.stringify(markers));
        alert("Marcadores salvos com sucesso.");
      }

      function loadMarkers() {
        const savedMarkers = localStorage.getItem("markers");
        if (savedMarkers) {
          markers = JSON.parse(savedMarkers);
          for (let i = 0; i < markers.length; i++) {
            addMarker(markers[i]);
          }
          alert("Marcadores carregados com sucesso.");
        } else {
          alert("Não foi possível encontrar marcadores salvos.");
        }
      }
      function addMarkerFromInput() {
        const inputLat = document.getElementById("inputLat").value;
        const inputLng = document.getElementById("inputLng").value;
        const position = {
          function
          lat: parseFloat(inputLat),
          lng: parseFloat(inputLng),
        };
        addMarker(position);
        markers.push(position);
      }

      function importMarkers() {
        const fileInput = document.getElementById("fileInput");
        const file = fileInput.files[0];
        const reader = new FileReader();
        reader.readAsText(file);
        reader.onload = () => {
          const importedMarkers = JSON.parse(reader.result);
          for (let i = 0; i < importedMarkers.length; i++) {
            addMarker(importedMarkers[i]);
            markers.push(importedMarkers[i]);
          }
          alert("Marcadores importados com sucesso.");
        };
      }

      function addNewMarker() {
        const input = document.getElementById("coordInput").value;
        const [lat, lng] = input.split(",");
        const position = { lat: parseFloat(lat), lng: parseFloat(lng) };
        addMarker(position);
        markers.push(position);
      }
    </script>
  </head>
  <body onload="initMap()">
    <h1>Mapa de Caixas de Fibra Ótica</h1>
    <div id="map" style="height: 500px"></div>
    <div>
      <button onclick="saveMarkers()">Salvar marcadores</button>
      <button onclick="loadMarkers()">Carregar marcadores salvos</button>
      <input type="file" id="fileInput" />
      <button onclick="importMarkers()">Importar marcadores</button>
    </div>
    <div>
      <input type="text" id="coordInput" placeholder="Digite uma coordenada" />
      <button onclick="addNewMarker()">Adicionar marcador</button>
    </div>
  </body>
</html>
